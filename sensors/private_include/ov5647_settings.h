#ifndef _OV5647_SETTINGS_H_
#define _OV5647_SETTINGS_H_

#include <stdint.h>
#include <stdbool.h>
#include "esp_attr.h"
#include "sensor.h"

#include "OV5647_regs.h"

/// @section Exposure
#define OV5647_EXPOSURE_MIN 4
#define OV5647_EXPOSURE_STEP 1
#define OV5647_EXPOSURE_DEFAULT 1000
#define OV5647_EXPOSURE_MAX 65535

/// @section Default dimensions
#define OV5647_DEFAULT_WIDTH 2624
#define OV5647_DEFAULT_HEIGHT 1956

/// @section Pixel array dimensions
#define OV5647_PA_LEFT 16
#define OV5647_PA_TOP 6
#define OV5647_PA_WIDTH 2592
#define OV5647_PA_HEIGHT 1944

/// @section
#define OV5647_VBLANK_MIN 24
#define OV5647_VTS_MAX 32767

/// @brief 20ms delay between power-on and configuration enabled
#define PWDN_ACTIVE_DELAY_MS 20

/// @section MIPI control
#define MIPI_CTRL00_CLOCK_LANE_GATE BIT(5)
#define MIPI_CTRL00_LINE_SYNC_ENABLE BIT(4)
#define MIPI_CTRL00_BUS_IDLE BIT(2)
#define MIPI_CTRL00_CLOCK_LANE_DISABLE BIT(0)

#define OV5647_ARRAY_SIZE(x) (sizeof(x) / sizeof((x)[0]))

typedef struct ov5647_regval
{
    uint16_t addr;
    uint8_t data;
} ov5647_regval_t;

typedef struct ov5647_mode
{
    pixformat_t format;
    resolution_info_t resolution;
    uint64_t pixel_rate;
    int hts;
    int vts_def;
    ov5647_regval_t *reg_list;
    unsigned int num_regs;
} ov5647_mode_t;

typedef struct ov5647_config
{
    ov5647_mode_t mode;

} ov5647_config_t;

/// @section Sensor configurations
static const ov5647_regval_t sensor_oe_disable_regs[] =
    {
        {OV5647_REG_IO_Y_OEN_H, 0x00},
        {OV5647_REG_IO_Y_OEN_L, 0x00},
        {OV5647_REG_IO_CTRL, 0x00},
};
static const ov5647_regval_t sensor_oe_enable_regs[] =
    {
        {OV5647_REG_IO_Y_OEN_H, 0x0f},
        {OV5647_REG_IO_Y_OEN_L, 0xff},
        {OV5647_REG_IO_CTRL, 0xe4},
};
static const ov5647_regval_t ov5647_sensor_fmt_yuv422[] =
{
    {},
    {},
    {},
};
static const ov5647_regval_t ov5647_640x480_8bit[] =
    {
        {OV5647_REG_SOFTWARE_SLEEP, 0x00},
        {OV5647_REG_SOFTWARE_RESET, 0x01},
        {0x3034, 0x08},
        {OV5647_REG_CLOCK_CTRL, 0x21},
        {OV5647_REG_PLL_MULTIPLIER, 0x46},
        {OV5647_REG_PLL_CTRL, 0x11},
        {0x3106, 0xf5},
        {OV5647_REG_MIRROR_CTRL, 0x01},
        {OV5647_REG_FLIP_CTRL, 0x41},
        {0x3827, 0xec},
        {0x370c, 0x0f},
        {0x3612, 0x59},
        {0x3618, 0x00},
        {OV5647_REG_ISP_CTRL, 0x06},
        {0x5002, 0x41},
        {0x5003, 0x08},
        {OV5647_REG_DIGITAL_CTRL, 0x08},
        {OV5647_REG_IO_Y_OEN_H, 0x00},
        {OV5647_REG_IO_Y_OEN_L, 0x00},
        {OV5647_REG_IO_CTRL, 0x00},
        {0x3016, 0x08},
        {0x3017, 0xe0},
        {OV5647_REG_INTERFACE_MODE, 0x44},
        {0x301c, 0xf8},
        {0x301d, 0xf0},
        {0x3a18, 0x00},
        {0x3a19, 0xf8},
        {OV5647_REG_BAND_DETECTION, 0x80},
        {OV5647_REG_STROBE_CTRL, 0x0c},
        {OV5647_REG_HTS_H, 0x07},
        {OV5647_REG_HTS_L, 0x68},
        {OV5647_REG_SUBSAMPLE_H, 0x31},
        {OV5647_REG_SUBSAMPLE_V, 0x31},
        {0x3708, 0x64},
        {0x3709, 0x52},
        {OV5647_REG_DVP_WIDTH_H, 0x02},
        {OV5647_REG_DVP_WIDTH_L, 0x80},
        {OV5647_REG_DVP_HEIGHT_H, 0x01},
        {OV5647_REG_DVP_HEIGHT_L, 0xE0},
        {OV5647_REG_X_START_L, 0x00},
        {OV5647_REG_Y_START_H, 0x00},
        {OV5647_REG_Y_START_L, 0x00},
        {OV5647_REG_X_END_H, 0x0a},
        {OV5647_REG_X_END_L, 0x3f},
        {OV5647_REG_Y_END_H, 0x07},
        {OV5647_REG_Y_END_L, 0xa1},
        {0x3811, 0x08},
        {0x3813, 0x02},
        {0x3630, 0x2e},
        {0x3632, 0xe2},
        {0x3633, 0x23},
        {0x3634, 0x44},
        {0x3636, 0x06},
        {0x3620, 0x64},
        {0x3621, 0xe0},
        {0x3600, 0x37},
        {0x3704, 0xa0},
        {0x3703, 0x5a},
        {0x3715, 0x78},
        {0x3717, 0x01},
        {0x3731, 0x02},
        {0x370b, 0x60},
        {0x3705, 0x1a},
        {0x3f05, 0x02},
        {0x3f06, 0x10},
        {0x3f01, 0x0a},
        {OV5647_REG_B50_STEP_H, 0x01},
        {0x3a09, 0x27},
        {OV5647_REG_B50_STEP_L, 0x00},
        {0x3a0b, 0xf6},
        {0x3a0d, 0x04},
        {0x3a0e, 0x03},
        {OV5647_REG_WPT_ENTER, 0x58},
        {OV5647_REG_BPT_ENTER, 0x50},
        {OV5647_REG_WPT_EXIT, 0x58},
        {OV5647_REG_BPT_EXIT, 0x50},
        {OV5647_REG_VPT_HIGH, 0x60},
        {OV5647_REG_VPT_LOW, 0x28},
        {OV5647_REG_BLC_START_LINE, 0x02},
        {OV5647_REG_BLC_LINE_NUM, 0x02},
        {OV5647_REG_BLC_CTRL, 0x09},
        {0x4837, 0x24},
        {0x4050, 0x6e},
        {0x4051, 0x8f},
        {OV5647_REG_SOFTWARE_SLEEP, 0x01},
};
static const ov5647_regval_t ov5647_2592x1944_10bit[] = {
    {OV5647_REG_SOFTWARE_SLEEP, 0x00},
    {OV5647_REG_SOFTWARE_RESET, 0x01},
    {0x3034, 0x1a},
    {OV5647_REG_CLOCK_CTRL, 0x21},
    {OV5647_REG_PLL_MULTIPLIER, 0x69},
    {OV5647_REG_PLL_CTRL, 0x11},
    {0x3106, 0xf5},
    {OV5647_REG_MIRROR_CTRL, 0x00},
    {OV5647_REG_FLIP_CTRL, 0x00},
    {0x3827, 0xec},
    {0x370c, 0x03},
    {0x3612, 0x5b},
    {0x3618, 0x04},
    {OV5647_REG_ISP_CTRL, 0x06},
    {0x5002, 0x41},
    {0x5003, 0x08},
    {OV5647_REG_DIGITAL_CTRL, 0x08},
    {OV5647_REG_IO_Y_OEN_H, 0x00},
    {OV5647_REG_IO_Y_OEN_L, 0x00},
    {OV5647_REG_IO_CTRL, 0x00},
    {0x3016, 0x08},
    {0x3017, 0xe0},
    {OV5647_REG_INTERFACE_MODE, 0x44},
    {0x301c, 0xf8},
    {0x301d, 0xf0},
    {0x3a18, 0x00},
    {0x3a19, 0xf8},
    {OV5647_REG_BAND_DETECTION, 0x80},
    {OV5647_REG_STROBE_CTRL, 0x0c},
    {OV5647_REG_HTS_H, 0x0b},
    {OV5647_REG_HTS_L, 0x1c},
    {OV5647_REG_SUBSAMPLE_H, 0x11},
    {OV5647_REG_SUBSAMPLE_V, 0x11},
    {0x3708, 0x64},
    {0x3709, 0x12},
    {OV5647_REG_DVP_WIDTH_H, 0x0a},
    {OV5647_REG_DVP_WIDTH_L, 0x20},
    {OV5647_REG_DVP_HEIGHT_H, 0x07},
    {OV5647_REG_DVP_HEIGHT_L, 0x98},
    {OV5647_REG_X_START_H, 0x00},
    {OV5647_REG_X_START_L, 0x00},
    {OV5647_REG_Y_START_H, 0x00},
    {OV5647_REG_Y_START_L, 0x00},
    {OV5647_REG_X_END_H, 0x0a},
    {OV5647_REG_X_END_L, 0x3f},
    {OV5647_REG_Y_END_H, 0x07},
    {OV5647_REG_Y_END_L, 0xa3},
    {0x3811, 0x10},
    {0x3813, 0x06},
    {0x3630, 0x2e},
    {0x3632, 0xe2},
    {0x3633, 0x23},
    {0x3634, 0x44},
    {0x3636, 0x06},
    {0x3620, 0x64},
    {0x3621, 0xe0},
    {0x3600, 0x37},
    {0x3704, 0xa0},
    {0x3703, 0x5a},
    {0x3715, 0x78},
    {0x3717, 0x01},
    {0x3731, 0x02},
    {0x370b, 0x60},
    {0x3705, 0x1a},
    {0x3f05, 0x02},
    {0x3f06, 0x10},
    {0x3f01, 0x0a},
    {OV5647_REG_B50_STEP_H, 0x01},
    {0x3a09, 0x28},
    {OV5647_REG_B50_STEP_L, 0x00},
    {0x3a0b, 0xf6},
    {0x3a0d, 0x08},
    {0x3a0e, 0x06},
    {OV5647_REG_WPT_ENTER, 0x58},
    {OV5647_REG_BPT_ENTER, 0x50},
    {OV5647_REG_WPT_EXIT, 0x58},
    {OV5647_REG_BPT_EXIT, 0x50},
    {OV5647_REG_VPT_HIGH, 0x60},
    {OV5647_REG_VPT_LOW, 0x28},
    {OV5647_REG_BLC_START_LINE, 0x02},
    {OV5647_REG_BLC_LINE_NUM, 0x04},
    {OV5647_REG_BLC_CTRL, 0x09},
    {0x4837, 0x19},
    {0x4800, 0x24},
    {OV5647_REG_MANUAL_CTRL, 0x03},
    {OV5647_REG_SOFTWARE_SLEEP, 0x01},
};
static struct ov5647_regval_t ov5647_640x480_10bit[] = {
    {OV5647_REG_SOFTWARE_SLEEP, 0x00},
    {OV5647_REG_SOFTWARE_RESET, 0x01},
    {OV5647_REG_CLOCK_CTRL, 0x11},
    {OV5647_REG_PLL_MULTIPLIER, 0x46},
    {OV5647_REG_PLL_CTRL, 0x11},
    {OV5647_REG_MIRROR_CTRL, 0x01},
    {OV5647_REG_FLIP_CTRL, 0x41},
    {0x370c, 0x03},
    {0x3612, 0x59},
    {0x3618, 0x00},
    {OV5647_REG_ISP_CTRL, 0x06},
    {0x5003, 0x08},
    {OV5647_REG_DIGITAL_CTRL, 0x08},
    {OV5647_REG_IO_Y_OEN_H, 0xff},
    {OV5647_REG_IO_Y_OEN_L, 0xff},
    {OV5647_REG_IO_CTRL, 0xff},
    {0x301d, 0xf0},
    {0x3a18, 0x00},
    {0x3a19, 0xf8},
    {OV5647_REG_BAND_DETECTION, 0x80},
    {OV5647_REG_STROBE_CTRL, 0x0c},
    {OV5647_REG_HTS_H, 0x07},
    {OV5647_REG_HTS_L, 0x3c},
    {OV5647_REG_SUBSAMPLE_H, 0x35},
    {OV5647_REG_SUBSAMPLE_V, 0x35},
    {0x3708, 0x64},
    {0x3709, 0x52},
    {OV5647_REG_DVP_WIDTH_H, 0x02},
    {OV5647_REG_DVP_WIDTH_L, 0x80},
    {OV5647_REG_DVP_HEIGHT_H, 0x01},
    {OV5647_REG_DVP_HEIGHT_L, 0xe0},
    {OV5647_REG_X_START_H, 0x00},
    {OV5647_REG_X_START_L, 0x10},
    {OV5647_REG_Y_START_H, 0x00},
    {OV5647_REG_Y_START_L, 0x00},
    {OV5647_REG_X_END_H, 0x0a},
    {OV5647_REG_X_END_L, 0x2f},
    {OV5647_REG_Y_END_H, 0x07},
    {OV5647_REG_Y_END_L, 0x9f},
    {0x3630, 0x2e},
    {0x3632, 0xe2},
    {0x3633, 0x23},
    {0x3634, 0x44},
    {0x3620, 0x64},
    {0x3621, 0xe0},
    {0x3600, 0x37},
    {0x3704, 0xa0},
    {0x3703, 0x5a},
    {0x3715, 0x78},
    {0x3717, 0x01},
    {0x3731, 0x02},
    {0x370b, 0x60},
    {0x3705, 0x1a},
    {0x3f05, 0x02},
    {0x3f06, 0x10},
    {0x3f01, 0x0a},
    {OV5647_REG_B50_STEP_H, 0x01},
    {0x3a09, 0x2e},
    {OV5647_REG_B50_STEP_L, 0x00},
    {0x3a0b, 0xfb},
    {0x3a0d, 0x02},
    {0x3a0e, 0x01},
    {OV5647_REG_WPT_ENTER, 0x58},
    {OV5647_REG_BPT_ENTER, 0x50},
    {OV5647_REG_WPT_EXIT, 0x58},
    {OV5647_REG_BPT_EXIT, 0x50},
    {OV5647_REG_VPT_HIGH, 0x60},
    {OV5647_REG_VPT_LOW, 0x28},
    {OV5647_REG_BLC_START_LINE, 0x02},
    {OV5647_REG_BLC_LINE_NUM, 0x02},
    {OV5647_REG_BLC_CTRL, 0x09},
    {OV5647_REG_IO_Y_OEN_H, 0x00},
    {OV5647_REG_IO_Y_OEN_L, 0x00},
    {OV5647_REG_IO_CTRL, 0x00},
    {0x3017, 0xe0},
    {0x301c, 0xfc},
    {0x3636, 0x06},
    {0x3016, 0x08},
    {0x3827, 0xec},
    {OV5647_REG_INTERFACE_MODE, 0x44},
    {OV5647_REG_CLOCK_CTRL, 0x21},
    {0x3106, 0xf5},
    {0x3034, 0x1a},
    {0x301c, 0xf8},
    {0x4800, 0x34},
    {OV5647_REG_MANUAL_CTRL, 0x03},
    {OV5647_REG_SOFTWARE_SLEEP, 0x01},
};
static struct ov5647_regval_t ov5647_1080p30_10bit[] = {
    {OV5647_REG_SOFTWARE_SLEEP, 0x00},
    {OV5647_REG_SOFTWARE_RESET, 0x01},
    {0x3034, 0x1a},
    {OV5647_REG_CLOCK_CTRL, 0x21},
    {OV5647_REG_PLL_MULTIPLIER, 0x62},
    {OV5647_REG_PLL_CTRL, 0x11},
    {0x3106, 0xf5},
    {OV5647_REG_MIRROR_CTRL, 0x00},
    {OV5647_REG_FLIP_CTRL, 0x00},
    {0x3827, 0xec},
    {0x370c, 0x03},
    {0x3612, 0x5b},
    {0x3618, 0x04},
    {OV5647_REG_ISP_CTRL, 0x06},
    {0x5002, 0x41},
    {0x5003, 0x08},
    {OV5647_REG_DIGITAL_CTRL, 0x08},
    {OV5647_REG_IO_Y_OEN_H, 0x00},
    {OV5647_REG_IO_Y_OEN_L, 0x00},
    {OV5647_REG_IO_CTRL, 0x00},
    {0x3016, 0x08},
    {0x3017, 0xe0},
    {OV5647_REG_INTERFACE_MODE, 0x44},
    {0x301c, 0xf8},
    {0x301d, 0xf0},
    {0x3a18, 0x00},
    {0x3a19, 0xf8},
    {OV5647_REG_BAND_DETECTION, 0x80},
    {OV5647_REG_STROBE_CTRL, 0x0c},
    {OV5647_REG_HTS_H, 0x09},
    {OV5647_REG_HTS_L, 0x70},
    {OV5647_REG_SUBSAMPLE_H, 0x11},
    {OV5647_REG_SUBSAMPLE_V, 0x11},
    {0x3708, 0x64},
    {0x3709, 0x12},
    {OV5647_REG_DVP_WIDTH_H, 0x07},
    {OV5647_REG_DVP_WIDTH_L, 0x80},
    {OV5647_REG_DVP_HEIGHT_H, 0x04},
    {OV5647_REG_DVP_HEIGHT_L, 0x38},
    {OV5647_REG_X_START_H, 0x01},
    {OV5647_REG_X_START_L, 0x5c},
    {OV5647_REG_Y_START_H, 0x01},
    {OV5647_REG_Y_START_L, 0xb2},
    {OV5647_REG_X_END_H, 0x08},
    {OV5647_REG_X_END_L, 0xe3},
    {OV5647_REG_Y_END_H, 0x05},
    {OV5647_REG_Y_END_L, 0xf1},
    {0x3811, 0x04},
    {0x3813, 0x02},
    {0x3630, 0x2e},
    {0x3632, 0xe2},
    {0x3633, 0x23},
    {0x3634, 0x44},
    {0x3636, 0x06},
    {0x3620, 0x64},
    {0x3621, 0xe0},
    {0x3600, 0x37},
    {0x3704, 0xa0},
    {0x3703, 0x5a},
    {0x3715, 0x78},
    {0x3717, 0x01},
    {0x3731, 0x02},
    {0x370b, 0x60},
    {0x3705, 0x1a},
    {0x3f05, 0x02},
    {0x3f06, 0x10},
    {0x3f01, 0x0a},
    {OV5647_REG_B50_STEP_H, 0x01},
    {0x3a09, 0x4b},
    {OV5647_REG_B50_STEP_L, 0x01},
    {0x3a0b, 0x13},
    {0x3a0d, 0x04},
    {0x3a0e, 0x03},
    {OV5647_REG_WPT_ENTER, 0x58},
    {OV5647_REG_BPT_ENTER, 0x50},
    {OV5647_REG_WPT_EXIT, 0x58},
    {OV5647_REG_BPT_EXIT, 0x50},
    {OV5647_REG_VPT_HIGH, 0x60},
    {OV5647_REG_VPT_LOW, 0x28},
    {OV5647_REG_BLC_START_LINE, 0x02},
    {OV5647_REG_BLC_LINE_NUM, 0x04},
    {OV5647_REG_BLC_CTRL, 0x09},
    {0x4837, 0x19},
    {0x4800, 0x34},
    {OV5647_REG_MANUAL_CTRL, 0x03},
    {OV5647_REG_SOFTWARE_SLEEP, 0x01},
};
static struct ov5647_regval_t ov5647_2x2binned_10bit[] = {
    {OV5647_REG_SOFTWARE_SLEEP, 0x00},
    {OV5647_REG_SOFTWARE_RESET, 0x01},
    {0x3034, 0x1A},
    {OV5647_REG_CLOCK_CTRL, 0x21},
    {OV5647_REG_PLL_MULTIPLIER, 0x62},
    {OV5647_REG_PLL_CTRL, 0x11},
    {0x3106, 0xF5},
    {0x3827, 0xEC},
    {0x370C, 0x03},
    {0x3612, 0x59},
    {0x3618, 0x00},
    {OV5647_REG_ISP_CTRL, 0x06},
    {0x5002, 0x41},
    {0x5003, 0x08},
    {OV5647_REG_DIGITAL_CTRL, 0x08},
    {OV5647_REG_IO_Y_OEN_H, 0x00},
    {OV5647_REG_IO_Y_OEN_L, 0x00},
    {OV5647_REG_IO_CTRL, 0x00},
    {0x3016, 0x08},
    {0x3017, 0xE0},
    {OV5647_REG_INTERFACE_MODE, 0x44},
    {0x301C, 0xF8},
    {0x301D, 0xF0},
    {0x3A18, 0x00},
    {0x3A19, 0xF8},
    {OV5647_REG_BAND_DETECTION, 0x80},
    {OV5647_REG_STROBE_CTRL, 0x0C},
    {OV5647_REG_X_START_H, 0x00},
    {OV5647_REG_X_START_L, 0x00},
    {OV5647_REG_Y_START_H, 0x00},
    {OV5647_REG_Y_START_L, 0x00},
    {OV5647_REG_X_END_H, 0x0A},
    {OV5647_REG_X_END_L, 0x3F},
    {OV5647_REG_Y_END_H, 0x07},
    {OV5647_REG_Y_END_L, 0xA3},
    {OV5647_REG_DVP_WIDTH_H, 0x05},
    {OV5647_REG_DVP_WIDTH_L, 0x10},
    {OV5647_REG_DVP_HEIGHT_H, 0x03},
    {OV5647_REG_DVP_HEIGHT_L, 0xCC},
    {OV5647_REG_HTS_H, 0x07},
    {OV5647_REG_HTS_L, 0x68},
    {0x3811, 0x0c},
    {0x3813, 0x06},
    {OV5647_REG_SUBSAMPLE_H, 0x31},
    {OV5647_REG_SUBSAMPLE_V, 0x31},
    {0x3630, 0x2E},
    {0x3632, 0xE2},
    {0x3633, 0x23},
    {0x3634, 0x44},
    {0x3636, 0x06},
    {0x3620, 0x64},
    {0x3621, 0xE0},
    {0x3600, 0x37},
    {0x3704, 0xA0},
    {0x3703, 0x5A},
    {0x3715, 0x78},
    {0x3717, 0x01},
    {0x3731, 0x02},
    {0x370B, 0x60},
    {0x3705, 0x1A},
    {0x3F05, 0x02},
    {0x3F06, 0x10},
    {0x3F01, 0x0A},
    {OV5647_REG_B50_STEP_H, 0x01},
    {0x3A09, 0x28},
    {OV5647_REG_B50_STEP_L, 0x00},
    {0x3A0B, 0xF6},
    {0x3A0D, 0x08},
    {0x3A0E, 0x06},
    {OV5647_REG_WPT_ENTER, 0x58},
    {OV5647_REG_BPT_ENTER, 0x50},
    {OV5647_REG_WPT_EXIT, 0x58},
    {OV5647_REG_BPT_EXIT, 0x50},
    {OV5647_REG_VPT_HIGH, 0x60},
    {OV5647_REG_VPT_LOW, 0x28},
    {OV5647_REG_BLC_START_LINE, 0x02},
    {OV5647_REG_BLC_LINE_NUM, 0x04},
    {OV5647_REG_BLC_CTRL, 0x09},
    {0x4837, 0x16},
    {0x4800, 0x24},
    {OV5647_REG_MANUAL_CTRL, 0x03},
    {OV5647_REG_FLIP_CTRL, 0x41},
    {OV5647_REG_MIRROR_CTRL, 0x01},
    {OV5647_REG_GAIN_H, 0x00},
    {OV5647_REG_GAIN_L, 0x10},
    {OV5647_REG_EXPOSURE_H, 0x00},
    {OV5647_REG_EXPOSURE_M, 0x1A},
    {OV5647_REG_EXPOSURE_L, 0xF0},
    {0x3212, 0xA0},
    {OV5647_REG_SOFTWARE_SLEEP, 0x01},
};

/// @section Sensor configurations
static struct ov5647_mode supported_modes_8bit[] =
    {
        /// @section MODE 0: Original 8-bit VGA mode.
        {
            .format = {
                .code = MEDIA_BUS_FMT_SBGGR8_1X8,
                .colorspace = V4L2_COLORSPACE_RAW,
                .field = V4L2_FIELD_NONE,
                .width = 640,
                .height = 480},
            .crop = {
                .left = OV5647_PA_LEFT,
                .top = OV5647_PA_TOP,
                .width = 1280,
                .height = 960,
            },
            .pixel_rate = 77291670,
            .hts = 1896,
            .vts_def = 0x3d8,
            .reg_list = ov5647_640x480_8bit,
            .num_regs = OV5647_ARRAY_SIZE(ov5647_640x480_8bit)},
};

static struct ov5647_mode supported_modes_10bit[] =
    {
        /// @section MODE 0: 2592x1944 full resolution full FOV 10-bit mode.
        {
            .format = {
                .code = MEDIA_BUS_FMT_SBGGR10_1X10,
                .colorspace = V4L2_COLORSPACE_RAW,
                .field = V4L2_FIELD_NONE,
                .width = 2592,
                .height = 1944},
            .crop = {.left = OV5647_PA_LEFT, .top = OV5647_PA_TOP, .width = 2592, .height = 1944},
            .pixel_rate = 87500000,
            .hts = 2844,
            .vts_def = 0x7b0,
            .reg_list = ov5647_2592x1944_10bit,
            .num_regs = OV5647_ARRAY_SIZE(ov5647_2592x1944_10bit)},

        /// @section MODE 1: 1080p30 10-bit mode.
        /// Full resolution centre-cropped down to 1080p.
        {.format = {.code = MEDIA_BUS_FMT_SBGGR10_1X10, .colorspace = V4L2_COLORSPACE_RAW, .field = V4L2_FIELD_NONE, .width = 1920, .height = 1080}, .crop = {
                                                                                                                                                         .left = 364,
                                                                                                                                                         .top = 450,
                                                                                                                                                         .width = 1928,
                                                                                                                                                         .height = 1080,
                                                                                                                                                     },
         .pixel_rate = 81666700,
         .hts = 2416,
         .vts_def = 0x450,
         .reg_list = ov5647_1080p30_10bit,
         .num_regs = OV5647_ARRAY_SIZE(ov5647_1080p30_10bit)},

        /// @section MODE 2: 2x2 binned full FOV 10-bit mode.
        {.format = {.code = MEDIA_BUS_FMT_SBGGR10_1X10, .colorspace = V4L2_COLORSPACE_RAW, .field = V4L2_FIELD_NONE, .width = 1296, .height = 972}, .crop = {
                                                                                                                                                        .left = OV5647_PA_LEFT,
                                                                                                                                                        .top = OV5647_PA_TOP,
                                                                                                                                                        .width = 2592,
                                                                                                                                                        .height = 1944,
                                                                                                                                                    },
         .pixel_rate = 81666700,
         .hts = 1896,
         .vts_def = 0x59b,
         .reg_list = ov5647_2x2binned_10bit,
         .num_regs = OV5647_ARRAY_SIZE(ov5647_2x2binned_10bit)},

        /// @section MODE 3: 10-bit VGA full FOV mode 60fps.
        /// 2x2 binned and subsampled down to VGA.
        {.format = {.code = MEDIA_BUS_FMT_SBGGR10_1X10, .colorspace = V4L2_COLORSPACE_RAW, .field = V4L2_FIELD_NONE, .width = 640, .height = 480}, .crop = {
                                                                                                                                                       .left = OV5647_PA_LEFT,
                                                                                                                                                       .top = OV5647_PA_TOP,
                                                                                                                                                       .width = 2560,
                                                                                                                                                       .height = 1920,
                                                                                                                                                   },
         .pixel_rate = 55000000,
         .hts = 1852,
         .vts_def = 0x1f8,
         .reg_list = ov5647_640x480_10bit,
         .num_regs = OV5647_ARRAY_SIZE(ov5647_640x480_10bit)},
};

/// @brief Use 2x2 binned 10-bit mode as default.
#define OV5647_DEFAULT_MODE (&supported_modes_10bit[2])

#endif
